
<div class="full-height m-t-40">
    <!-- TABLES VIEW -->
    <div class="container-fluid container-fixed-lg">
        <!-- START PANEL -->
        <div class="panel panel-transparent">
            <div class="panel-heading">
                <div class="panel-title">Purchase Order
                </div>
                <div class="pull-right" style="width: 60%;">
                    <button id="show-modal2" class="btn btn-primary pull-right" ng-click="openAdvancedFilter(true)"><i class="fa fa-search"></i></button>
                    <!--<button id="show-modal" class="btn btn-primary btn-cons pull-right" ng-click="openQuickView('add')" ng-if="show.prTable" ng-show="buttonCreate"><i class="fa fa-plus"></i> Add PO</button>-->
                    <!--<button id="show-modal" class="btn btn-primary btn-cons pull-right" ng-click="openQuickViewItem('add')" ng-if="show.itemTable" ng-show="addItem"><i class="fa fa-plus"></i> Add Item</button>-->
                    <div class="input-group date col-sm-4 pull-right m-r-10">
                        <input type="text" id="search-table" class="form-control pull-right" placeholder="Search PO Number.." ng-keyup="filter('search',$event)" ng-model="filterVal.search">
                    </div>

                </div>
                <div class="clearfix"></div>
                <div class="tools">
                    <a class="collapse" href="javascript:;"></a>
                    <a class="config" data-toggle="modal" href="#grid-config"></a>
                    <a class="reload" href="javascript:;"></a>
                    <a class="remove" href="javascript:;"></a>
                </div>
                <div class="panel panel-default m-t-5" pg-portlet ng-show="showAdvance">
                    <div class="panel-heading">
                        <div class="panel-title">Advanced Search
                        </div>
                        <div class="panel-controls">
                            <ul>
                                <li><a href="" ng-click="openAdvancedFilter(false)"><i class="portlet-icon portlet-icon-close"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel-body" >
                        <div class="row col-md-12">
                            <div class="btn-group dropdown-default pull-left  m-r-5">
                                <label>Status:</label><br />
                                <ui-select multiple ng-model="selected.filter_status" theme="select2" ng-disabled="disabled" style="width: 300px;" >
                                    <ui-select-match placeholder="Filter Status...">{{$item.name}}</ui-select-match>
                                    <ui-select-choices repeat="item in delivery_status | filter:$select.search">
                                        {{item.name}}
                                    </ui-select-choices>
                                </ui-select>
                             </div>
                             <div class="input-prepend input-group pull-left lDate m-r-5" >
                                 <label>Delivery Date:</label><br />
                                <input type="text" class="form-control" ng-model="f.filter_date" name="filter_date" placeholder="Pick a date" ui-jq="datepicker" data-date-format="yyyy-mm-dd" >
                                <!--<span class="add-on input-group-addon bDate"><i class="glyphicon glyphicon-calendar fa fa-calendar"></i></span>-->
                            </div>
                            <div class="btn-group form-group-default-select pull-left  m-r-5">
                                <label>Source:</label><br />
                                <ui-select ng-model="selected.filter_source.selected" theme="bootstrap"  >
                                    <ui-select-match placeholder="Select Source">{{$select.selected.name}}</ui-select-match>
                                    <ui-select-choices repeat="item in source | filter: $select.search">
                                        <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                    </ui-select-choices>
                                </ui-select>
                             </div>
                            <div class="btn-group form-group-default-select pull-left  m-r-5">
                                <label>Store Location:</label><br />
                                <ui-select ng-model="selected.filter_warehouse.selected" theme="bootstrap"  >
                                    <ui-select-match placeholder="Select Location">{{$select.selected.name}}</ui-select-match>
                                    <ui-select-choices repeat="item in warehouse | filter: $select.search">
                                        <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                    </ui-select-choices>
                                </ui-select>
                             </div>
                        </div>

                        <div class="row col-md-12 m-t-10">
                            <div class="btn-group form-group-default-select pull-left  m-r-5">
                                <label>Cost Center:</label><br />
                                <ui-select ng-model="selected.filter_cost_center.selected" theme="bootstrap" ng-keyup="costCenterUp($select.search)" ng-disabled="viewMode" on-select="pr.cost_center_id=selected.cost_center.selected.id" >
                                    <ui-select-match placeholder="Pick Cost Center">{{$select.selected.code}}</ui-select-match>
                                    <ui-select-choices repeat="item in cost_center | filter: $select.search">
                                        <div ng-bind-html="trustAsHtml((item.code | highlight: $select.search))"></div>
                                        <small ng-bind-html="trustAsHtml((item.dept_desc | highlight: $select.search))"></small>
                                    </ui-select-choices>
                                </ui-select>
                             </div>
                             <div class="btn-group form-group-default-select pull-left  m-r-5">
                                 <label>Supplier:</label><br />
                                 <ui-select ng-model="selected.filter_supplier.selected" theme="bootstrap" ng-keyup="supplierUp($select.search)" ui-jq="popover" data-container="body" data-placement="top" data-content="This field is required" data-trigger="manual" validate-attached-form-element required>
                                     <ui-select-match placeholder="Pick Supplier">{{$select.selected.name}}</ui-select-match>
                                     <ui-select-choices repeat="item in supplier | filter: $select.search">
                                         <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                     </ui-select-choices>
                                 </ui-select>
                              </div>

                            <div class="btn-group dropdown-default pull-left  m-r-5" >
                                <label>&nbsp;</label><br />
                              <button id="show-modal" class="btn btn-primary pull-right" ng-click="applyFilter()" ><i class="fa fa-search"></i> Apply</button>
                             </div>
                        </div>





                        <!--<div class="input-prepend input-group date col-sm-4 pull-right m-r-5" style="width: 250px;" >
                          <input date-range-picker type="text" placeholder="filter due date" class="form-control date-picker lDate">
                          <span class="add-on input-group-addon bDate"><i class="fa fa-calendar"></i></span>
                      </div>-->



                    </div>
                </div>
            </div>
            <div class="panel-body">
                <div id="divPr" >
                    <table class="table table-hover table-condensed " id="prTable" name="prTable" datatable dt-options="dtOptions" dt-columns="dtColumns" dt-instance="nested.dtInstance">
                    </table>
                </div>

            </div>
        </div>
    <!-- END PANEL -->
    </div>

<!--START FORM INPUT-->
<div class="modal fade slide-right form-input-full" id="form-input" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content-wrapper">
      <div class="modal-content" style="background-image: url('pages/mtbgform.png');">
      <div class="panel-heading">
       <div class="panel-title">Purchase Order Information</div>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="pg-close fs-14"></i>
        </button>
       </div>
        <div class="container-xs-height full-height">
          <div class="row-xs-height">
            <div class="modal-body col-xs-height col-top">

      <!-- START FORM -->
      <div class="panel panel-transparent m-t-20">

          <form id="form-user" role="form" autocomplete="off" name="dodol" novalidate>
              <div class="row clearfix">
              <div class="col-sm-12">
                  <h4>PO Document</h4>
                  <div class="row clearfix">
                      <div class="col-sm-12">
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default required" ng-class="{ 'has-error' : po.code.$invalid && !po.code.$pristine }">
                                  <label>Code</label>
                                  <input type="text" class="form-control" name="code" ng-model="po.code" ui-jq="popover" data-container="body" data-placement="top" data-content="This field is required" data-trigger="manual" validate-attached-form-element required ng-disabled="viewMode">
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default form-group-default-select  required" ng-class="{ 'has-error' : po.delivery_status.$invalid && !po.delivery_status.$pristine }" >
                                  <label>Status</label>
                                  <ui-select ng-model="selected.delivery_status.selected" theme="bootstrap" on-select="po.delivery_status=$select.selected.id">
                                      <ui-select-match placeholder="Select Status">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in delivery_status | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default form-group-default-select " >
                                  <label>Delivered To</label>
                                  <ui-select ng-model="selected.warehouse.selected" theme="bootstrap"  on-select="po.warehouse_id=selected.warehouse.selected.id">
                                      <ui-select-match placeholder="Select Location">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in warehouse | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>
                          <div class="col-md-3">
                              <!--<div pg-form-group class="form-group form-group-default form-group-default-select  required" ng-class="{ 'has-error' : pr.cost_center_id.$invalid && !pr.cost_center_id.$pristine }">
                                  <label>Cost Center</label>
                                  <ui-select ng-model="selected.cost_center.selected" theme="bootstrap" ng-disabled="viewMode" on-select="pr.cost_center_id=selected.cost_center.selected.id" ui-jq="popover" data-container="body" data-placement="top" data-content="This field is required" data-trigger="manual" validate-attached-form-element required>
                                      <ui-select-match placeholder="Pick Cost Center">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in cost_center | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>-->
                              <div pg-form-group class="form-group form-group-default form-group-default-select ">
                                  <label>Cost Center</label>
                                  <ui-select ng-model="selected.cost_center.selected" theme="bootstrap" ng-keyup="costCenterUp($select.search)" ng-disabled="viewMode" on-select="pr.cost_center_id=selected.cost_center.selected.id" >
                                      <ui-select-match placeholder="Pick Cost Center">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in cost_center | filter: $select.search">
                                          <div ng-bind-html="trustAsHtml((item.code | highlight: $select.search))"></div>
                                          <small ng-bind-html="trustAsHtml((item.dept_desc | highlight: $select.search))"></small>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>


                      </div>
                      <div class="col-sm-12">
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default required" ng-class="{ 'has-error' : po.delivery_date.$invalid && !po.delivery_date.$pristine }">
                                  <label>Delivery Date</label>
                                  <input type="text" class="form-control" ng-model="po.delivery_date" name="delivery_date" placeholder="Pick a date" id="startDate" ui-jq="datepicker" ng-model="contract.startDate" data-date-format="yyyy-mm-dd" ui-jq="popover" data-container="body" data-placement="top" data-content="This field is required" data-trigger="manual" validate-attached-form-element required ng-disabled="viewMode">
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default" >
                                  <label>PR Code</label>
                                  <input type="text" class="form-control" name="notes" ng-model="po.pr_id" >
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default" >
                                  <label>ML Code</label>
                                  <input type="text" class="form-control" name="notes" ng-model="po.ml_id" >
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default" >
                                  <label>Purchase Notes</label>
                                  <input type="text" class="form-control" name="notes" ng-model="po.notes" >
                              </div>
                          </div>
                      </div>

                      <div class="col-sm-12">
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default form-group-default-select required" ng-class="{ 'has-error' : po.supplier_id.$invalid && !po.supplier_id.$pristine }">
                                  <label>Supplier</label>
                                  <ui-select ng-model="selected.supplier.selected" theme="bootstrap" ng-disabled="viewMode" on-select="po.supplier_id=selected.supplier.selected.id" ng-keyup="supplierUp($select.search)" ui-jq="popover" data-container="body" data-placement="top" data-content="This field is required" data-trigger="manual" validate-attached-form-element required>
                                      <ui-select-match placeholder="Pick Supplier">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in supplier | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default form-group-default-select ">
                                  <label>Payment</label>
                                  <ui-select ng-model="selected.payment_type.selected" theme="bootstrap" ng-disabled="viewMode" on-select="po.payment_type=selected.payment_type.selected.id" >
                                      <ui-select-match placeholder="Pick Payment">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in payment_type | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default" >
                                  <label>Due Days</label>
                                  <input type="number" class="form-control" name="notes" ng-model="po.due_days" >
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div pg-form-group class="form-group form-group-default form-group-default-select ">
                                  <label>Currency</label>
                                  <ui-select ng-model="selected.currency.selected" theme="bootstrap" ng-disabled="viewMode" on-select="po.currency=selected.currency.selected.id" >
                                      <ui-select-match placeholder="Pick Currency">{{$select.selected.name}}</ui-select-match>
                                      <ui-select-choices repeat="item in currency | filter: $select.search">
                                          <span ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></span>
                                      </ui-select-choices>
                                  </ui-select>
                              </div>
                          </div>





                      </div>




                  </div>
              </div>
              </div>
              <div class="row clearfix">
              <div class="col-sm-12">
                  <h4>List of Item</h4>
                  <div ng-controller="EditableTablePoCtrl" ng-form editable-form name="tableform" onaftersave="child.saveTable()" oncancel="cancel()" >
                                        <!-- table -->
                                        <table class="table  table-hover itemtable">
                                            <thead>
                                            <tr>
                                                <th width="10%"><span ng-show="tableform.$visible">Action</span></th>
                                                <th width="30%">Product</th>
                                                <th width="10%">Unit</th>
                                                <th width="10%">Qty</th>
                                                <th width="15%">Price</th>
                                                <th width="20%">Amount</th>
                                            </tr>
                                            </thead>

                                            <tbody>
                                            <tr ng-repeat="item in items | filter:filterUser">

                                                <td style="vertical-align: middle;">
                                                    <div class="btn-group btn-group-xs" ng-show="tableform.$visible">
                                                        <button type="button" class="btn btn-default" ng-click="deleteUser(item.id)" ><i class="fa fa-trash-o"></i></button>
                                                    </div>
                                                </td>
                                                <td >
                                                    <!--<span editable-text="item.product_name" e-form="tableform" onbeforesave="checkName($data, user.id)" style="width:100%;">
                                                        {{ item.product_name }}
                                                    </span>-->
                                                    <span editable-ui-select="item.product_name" theme="bootstrap" data-e-name="product_name" name="account" data-e-ng-model="selected.account.selected"
                                                    data-e-form="tableform" data-e-ng-keyup="productUp(item.id,$select.search)" data-e-on-select="getProduct($item,item.id)" >
                                                    {{item.product_name}}
                                                          <editable-ui-select-match placeholder="select product" style="width: 300px" >
                                                              <!--{{$select.selected.name}}-->
                                                              {{item.product_name || 'Empty'}}
                                                          </editable-ui-select-match>
                                                          <editable-ui-select-choices repeat="d in product[item.id] | filter: $select.search" style="width: 300px" >
                                                              <div ng-bind-html="trustAsHtml((d.name | highlight: $select.search))"></div>
                                                              <!--<small ng-bind-html="trustAsHtml((d.name | highlight: $select.search))"></small>-->
                                                          </editable-ui-select-choices>
                                                    </span>
                                                </td>
                                                <td><span>{{item.unit_name}}</span></td>
                                                <td>
                                                    <span editable-text="item.qty" e-form="tableform" data-e-ng-keyup="setValue($event,item.id,$data,'qty')">
                                                        {{ item.qty }}
                                                    </span></td>
                                                <td >
                                                    <span editable-text="item.price" e-form="tableform" data-e-ng-keyup="setValue($event,item.id,$data,'price')">
                                                        {{ item.price }}
                                                    </span>
                                                </td>
                                                <td><span>{{item.amount}}</span></td>

                                            </tr>

                                            </tbody>
                                        </table>

                                        <!-- buttons -->
                                        <div class="btn-edit">
                                          <button type="button" class="btn btn-primary" ng-show="!tableform.$visible" ng-click="tableform.$show()">
                                            Modify Item List
                                          </button>
                                        </div>
                                        <div class="btn-form" ng-show="tableform.$visible">

                                          <button type="submit" ng-disabled="tableform.$waiting" ng-click="tableform.$hide();child.saveTable(0)" class="btn btn-primary"> Save Item</button>
                                          <button type="button" ng-disabled="tableform.$waiting" ng-click="addUser()" class="btn btn-primary "> Add New Item</button>
                                          <button type="button" ng-disabled="tableform.$waiting" ng-click="tableform.$cancel()" class="btn btn-default">Cancel</button>
                                        </div>

                  </div>

                  <!--<div ng-if="show.itemTable" id="divItem" >-->
                  <!--<div  id="divItem" >
                      <table class="table table-condensed m-b-0" >
                          <tr>
                              <th width="5%">
                                  <div class="form-group">
                                      <button class="btn btn-primary btn-small pull-right" ng-click="addItem()" ng-show="addItem"><i class="fa fa-plus"></i></button>
                                  </div>
                              </th>
                              <th width="35%">
                                      <label width="100%">
                                          <div class="form-group clearfix">
                                              <ui-select ng-model="selected.product.selected" theme="bootstrap" on-select="getProductPrice($item)" ng-keyup="productUp($select.search)" style="width: 300px;">
                                                  <ui-select-match placeholder="Product...">{{$select.selected.name}}</ui-select-match>
                                                  <ui-select-choices repeat="item in products | filter: $select.search">
                                                      <div ng-bind-html="trustAsHtml((item.name | highlight: $select.search))"></div>
                                                  </ui-select-choices>
                                              </ui-select>
                                          </div>
                                      </label>

                              </th>
                              <th width="8%">
                                  <div class="form-group">
                                      <label>
                                          <input placeholder="Qty..." type="number" class="form-control" name="Qty" ng-model="item2Add.qty" value="1" ng-keyup="updatePrice($event)">
                                      </label>
                                  </div>
                              </th>
                              <th width="10%">
                                  <div class="form-group">
                                      <label>
                                          <input placeholder="Price..." type="number" class="form-control" name="Price" ng-model="item2Add.price" ng-value="item2Add.price" ng-keyup="updatePrice($event)">
                                      </label>
                                  </div>
                              </th>
                              <th width="10%">
                                  <div class="form-group">
                                      <label>
                                          <input placeholder="Amount..." type="text" class="form-control" name="Amount" ng-model="item2Add.amount" ng-value="item2Add.amount" ng-readonly="true">
                                      </label>
                                  </div>
                              </th>

                          </tr>
                      </table>
                        <table class="table table-hover itemtable" id="itemTable" name="itemTable"  dt-options="dtOptionsItem"  dt-column-defs="dtColumnDefs" dt-instance="nested.dtInstanceItem">
                            <thead>
                            <tr>
                                <th width="5%">Action</th>
                                <th width="35%">Product</th>
                                <th width="5%">Qty</th>
                                <th width="10%">Price</th>
                                <th width="10%">Amount</th>

                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="item in items">
                                <td width="5%">
                                    <div class="btn-group btn-group-xs">
                                        <button type="button" class="btn btn-default" ng-click="modifyItem($index)" ><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-default" ng-click="removeItem($index)" ><i class="fa fa-trash-o"></i></button>
                                    </div>
                                </td>
                                <td width="35%">{{ item.product_name }}</td>
                                <td width="5%">{{ item.qty }}</td>
                                <td width="10%">{{ item.price }}</td>
                                <td width="10%">{{ item.amount }}</td>

                            </tr>
                            </tbody>
                        </table>
                  </div>-->
              </div>
              </div>
              <br>
              <div class="row divider"></div>
              <div class="clearfix"></div>
              <button class="btn btn-primary" type="submit" ng-disabled="dodol.$invalid" ng-click="submit()" >Save</button>
              <button class="btn btn-default"><i class="pg-close"></i> Clear</button>
          </form>
      </div>
      <!-- END FORM -->

            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!--END FORM INPUT-->

<!-- START INPUT PRODUCT-->



<!-- START MODAL CONTENT-->
<div class="modal fade slide-up disable-scroll" id="modalDelete" tabindex="-1" role="dialog" aria-hidden="false">
    <div class="modal-dialog modal-sm">
        <div class="modal-content-wrapper">
            <div class="modal-content" style="background-image: url('pages/mtbgform.png');">
                <div class="modal-body text-center m-t-20">
                    <h4 class="no-margin p-b-10">Are you sure want to cancel PO  {{po.code}} ?</h4>
                    <div >
                        <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="execDelete()">Yes</button>
                        <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="clear()">No</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
</div>
<!-- END MODAL CONTENT-->
